<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Test Fractales Langues</title>
</head>
<body>
  <button onclick="switchLangue()">🌐 Changer de langue / Switch Language</button>
  <button id="btn_enter"></button>
  <button id="btn_quit"></button>
  <div id="intro"></div>

<script>

let langueActuelle = 'fr'; // langue par défaut

	async function chargerLangues(url) {
	  const re = /^\[([^\]]+)\]\s*["']([^"']+)["']/;
	  const dictionnaire = {};
	  const response = await fetch(url);
	  const texte = await response.text();
	  texte.split('\n').forEach(ligne => {
		const match = ligne.match(re);
		if (match) {
		  dictionnaire[match[1]] = match[2];
		}
	  });

	  return dictionnaire;
	}

function appliquerTextes(labels, langue) {
  for (const cle in labels) {
	const baseId = cle.endsWith(`_${langue}`) 
  ? cle.slice(0, -(`_${langue}`.length)) 
  : cle;
    const element = document.getElementById(baseId);
	alert(baseId);
    if (element) {
      element.textContent = labels[cle];
    }
  }
}

function switchLangue() {
  langueActuelle = langueActuelle === 'fr' ? 'en' : 'fr';
  localStorage.setItem('lang', langueActuelle);
  chargerLangues('https://ovalentini.github.io/Fractales/langues.txt').then(labels => {
    appliquerTextes(labels, langueActuelle);
  });
}

// Au chargement, appliquer la langue préférée ou par défaut
window.addEventListener('DOMContentLoaded', () => {
  chargerLangues('https://ovalentini.github.io/Fractales/langues.txt').then(labels => {
      appliquerTextes(labels, langueActuelle);
    });
});
</script>
</body>
</html>
